var d;function l(a){return l.i(a)}l.get=function(a){try{return l(a).get()}catch(b){return null}};l.D=[];l.option=function(a){return void 0==a?null:a};l.m=function(a){var b;if(1==arguments.length)if(a instanceof Array)for(b=0;b<a.length;b++)l.m(a[b]);else b=eval(a),l[a]=new n(b,a,obj)};l.i=function(a){a=a.split(".");for(var b=l,c=0;c<a.length;c++){var f=b[a[c]];if(f instanceof n)b=f;else if(b instanceof n)if(b.isArray())b=q(b,a[c]);else return null}return b};
l.B=function(a,b){var c=a.getAttribute(b);return null!=c&&s(c,"@{")&&t(c,"}")?new v(a,b,c.substr(2,c.length-3)):null};
l.h=function(a,b){if(a.hasAttribute("model"))l.v(a,b);else{var c;if(a.hasAttribute("bind")&&0==$(a).parents("[model]").length){if(null==a.getAttribute("bind")||""==a.getAttribute("bind")){c=[];for(var f=0;f<a.attributes.length;f++){var h=a.attributes[f].name,e=a.getAttribute(h);s(e,"@{")&&t(e,"}")&&c.push(h)}a.setAttribute("bind",c.toString())}else c=a.getAttribute("bind").split(",");h=c.length;for(f=0;f<h;f++)try{var g=l.B(a,c[f]);if(null!=g){var k;if(null!=b&&(s(g.a,"model")||t(g.a,"\\$model"))){if(k=
b,s(g.a,"model.")){var m=w(k,g.a.substring(6));m instanceof n&&!m.isFunction()&&m.e.push(g)}}else k=l.i(g.a),null!=b&&b.e.push(g);null!=k&&(k.e.push(g),$(g.elem).is("input")&&"checkbox"==g.elem.type&&"checked"==g.attrName?l.q(g.elem,k):$(g.elem).is("input")&&"radio"==g.elem.type&&"selected"==g.attrName?l.r(g.elem,k):$(g.elem).is("input")&&"text"==g.elem.type&&"value"==g.attrName?l.t(g.elem,k):$(g.elem).is("select")&&"selected"==g.attrName&&l.s(g.elem,k))}}catch(r){console.log("\u5e94\u7528\u7ed1\u5b9a\u65f6\u51fa\u9519\uff0c\u7ed1\u5b9a\u4fe1\u606f\uff1a"+
(null!=g?g.a+"\u3002":"\u9519\u8bef\u3002")+r.description)}a.removeAttribute("bind");$(a).find("[bind]").each(function(){l.h(this,b)})}}};l.v=function(a,b){var c=a.getAttribute("model");if(s(c,"model."))if(null!=b)c=w(b,c.substr(6));else return;else c=l.i(c);if(null!=c){c.k.push(a);if(c.isArray())for(var f=a,h=0,e=x(c);h<e;h++){b=c.get(h);var g=$(a).clone(!0).get(0);$(g).show();g.removeAttribute("model");$(g).data("modelElem",a);b.f.push(g);l.h(g,b);$(f).after(g);f=g}$(a).hide()}};l.u=function(){$("[bind]").each(function(){l.h(this)})};
l.p=["parent"];
l.apply=function(a,b){void 0==a&&(a=l);if(a!=l&&a.isArray())for(var c=0;c<a.b.length;c++)l.apply(a.b[c],b);else for(var f=a.e,h=null==f?0:f.length,c=0;c<h;c++){var e=f[c];if(e.elem!=b)try{var g=a.g,k,m;""==g?t(e.a,"\\$model")||s(e.a,"model.")?s(e.a,"model.")?(g=e.a.substring(6),m=w(a,g),k=m.get()):t(e.a,"\\$model")&&(g=""==g?e.a.substring(0,e.a.length-6):g.substring(0,g.length-6),m=l.i(g),k=m.get()):(m=l.i(e.a),k=m.get()):(m=a,k=a.get());var r=s(e.attrName,"on")?k:l.o(e,k,a,m.parent);if($(e.elem).is("input")||
"text"!=e.attrName)if($(e.elem).is("input")||"html"!=e.attrName)if($(e.elem).is("input")&&"checkbox"==e.elem.type&&"checked"==e.attrName)e.elem.checked=r;else if($(e.elem).is("input")&&"radio"==e.elem.type&&"selected"==e.attrName)e.elem.checked=r==e.elem.value;else if($(e.elem).is("select")&&"selected"==e.attrName)for(c=0;c<e.elem.options.length;c++){if(e.elem.options[c].selected=!1,e.elem.options[c].value==r||-1!=$.inArray(e.elem.options[c].value,r))e.elem.options[c].selected=!0}else if(s(e.attrName,
"on")){if(k instanceof Function){var y=e.attrName.substr(2);$(e.elem).off(y,l.j);$(e.elem).on(y,{A:k,C:m.parent,w:a},l.j)}}else e.elem.setAttribute(e.attrName,r);else $(e.elem).html(r);else $(e.elem).text(r)}catch(z){console.error("\u5e94\u7528\u7ed1\u5b9a\u65f6\u51fa\u9519\uff0c\u7ed1\u5b9a\u4fe1\u606f\uff1a"+(null!=e?e.a+"\u3002":"\u9519\u8bef\u3002")+z.description)}}for(var u in a)0>l.p.indexOf(u)&&!s(u,"_")&&a[u]instanceof n&&l.apply(a[u],b)};l.bind=function(){l.u();l.apply()};
l.o=function(a,b,c,f){return b instanceof Function?l.n(a,b,c,f):b};l.n=function(a,b,c,f){if(s(a.a,"model."))try{return b.call(f)}catch(h){console.log("\u8c03\u7528\u51fd\u6570\u5931\u8d25\uff1a"+a.a),console.error(h)}else try{return b.call(f,c)}catch(e){console.log("\u8c03\u7528\u51fd\u6570\u5931\u8d25\uff1a"+a.a),console.error(e)}return null};l.t=function(a,b){$(a).is("input")&&"text"==a.type&&$(a).bind("input propertychange",function(){b.put(void 0,this.value,a)})};
l.q=function(a,b){$(a).is("input")&&"checkbox"==a.type&&$(a).bind("change",function(){b.put(void 0,this.checked,a)})};l.r=function(a,b){$(a).is("input")&&"radio"==a.type&&$(a).bind("change",function(){b.put(void 0,this.value,a)})};l.s=function(a,b){$(a).is("select")&&$(a).bind("change",function(){for(var c=a.hasAttribute("multiple"),f=c?[]:"",h=0;h<a.options.length;h++)if(a.options[h].selected)if(c)f.push(a.options[h].value);else{f=a.options[h].value;break}b.put(void 0,f,a)})};
l.j=function(a){a.data.A.call(a.data.C,a.data.w,a)};window.Amber=l;l.bind=l.bind;l.apply=l.apply;l.bindElem=l.h;l.get=l.get;l.buildBindable=l.m;function n(a,b,c,f){this.g=b;this.l=a;this.c="object";this.d=null==c?window:c;this.k=[];this.b;this.e=[];this.f=[];this.parent=f;if(null==this.d)this.c="global";else if("function"==typeof a)this.c="function";else if($.isArray(a)){this.c="array";this.b=Array(a.length);for(b=0;b<a.length;b++)this.b[b]=new n(a[b],"",a,this);for(p in a)$.isNumeric(p)||(this[p]=new n(a[p],p,a,this))}else if("object"==typeof a)for(p in this.c="object",a)this[p]=new n(a[p],p,a,this);else this.c="native"}d=n.prototype;
d.isFunction=function(){return"function"==this.c};d.isArray=function(){return"array"==this.c};d.isNative=function(){return"native"==this.c};function x(a){return a.isArray()?a.l.length:0}d.remove=function(a){if(null==a){for(var b=this.e.length-1;0<=b;b--)a=this.e[b],this.e.remove(a),a.clear();for(b=this.f.length-1;0<=b;b--)$(this.f[b]).remove()}else if(this.isArray())for(b=0;b<this.b.length;b++)if(this.b[b]==a){a=this.b[b];this.b.remove(b);this.d[this.g].remove(b);a.remove();break}};
d.add=function(a){if(this.isArray()){this.d[this.g].push(a);var b=this.b[this.b.length-1];a=new n(a,"",this.d,this);this.b.push(a);for(var c,f,h,e=null==b?this.k:b.f,g=0;g<e.length;g++)c=e[g],h=null==b?c:$(c).data("modelElem"),f=$(h).clone(!0).get(0),$(f).show("slow"),a.f.push(f),f.removeAttribute("model"),$(f).data("modelElem",h),l.h(f,a),$(c).after(f);l.apply(a,void 0)}};function q(a,b){return a.isArray()&&$.isNumeric(b)&&parseInt(b)<a.b.length?a.b[parseInt(b)]:null}
d.get=function(a){void 0==a&&(a=this.g);if(this.isArray()){if($.isNumeric(a)&&(a=parseInt(a),0<=a&&a<=x(this)))return this.b[a]}else{if("object"==this.c)return this[a]instanceof n?this[a].d[a]:""==a?this.l:this.d[a];if(this.isNative())return this.d[a];if(this.isFunction())return void 0==this[a]?this.d[a]:this[a]}return null};
d.put=function(a,b,c){if("function"!=this.c){1==arguments.length&&(b=arguments[0],a=this.g);void 0==a&&(a=this.g);var f;f=a!=this.g||this.isNative()?w(this,a):this;if(f instanceof n)if(f.isNative())f.put(a,b);else if(f.isArray()){if(b instanceof Array){var h=x(f),e=b.length;Math.min(h,e);for(h-=1;0<=h;h--){var g=q(f,h);f.remove.call(g)}for(h=0;h<e;h++)f.add(b[h])}}else{if("object"==f.c){for(e in f)0<=",_attrName,_value,_type,_obj,_models,_rows,_bindingInfos,parent,_rowElems,_selectedProduct,".indexOf(","+
e+",")||b[e]instanceof Function||this[e]instanceof Function||f.put(e,b[e]);f.d=b}}else this.d[a]=b,l.apply(this,c)}return this};d.elements=function(){if(this.isArray()){for(var a=[],b=0;b<this.b;b++)a.push(this.b[b].elements());return a}if(null!=this.f&&0<this.f.length)return this.f;a=[];for(b=0;b<this.e;b++)a.push(this.e[b].elem);return a};d.call=function(){this.isFunction()&&this.get().apply(this.parent,arguments)};
function w(a,b){if(b instanceof Array){for(var c=b,f=a,h=0;h<c.length;h++){var e=c[h],g=f[e];if(null==g)if(f instanceof n&&f.isArray())g=q(f,e);else return null;f=g}return f}c=b.split(".");return w(a,c)}window.Bindable=n;n.prototype.elements=n.prototype.elements;function v(a,b,c){this.elem=l.option(a);this.attrName=l.option(b);this.a=l.option(c)}v.prototype.clear=function(){this.a=this.attrName=null;$(this.elem).remove()};function s(a,b){return(new RegExp("^"+b)).test(a)}function t(a,b){return(new RegExp(b+"$")).test(a)}Array.prototype.remove=function(a){if($.isNumeric(a))this.splice(a,1);else for(var b=0;b<this.length;b++)if(a===this[b]){this.splice(b,1);break}};
